##The following script requires Shodan CLI to be installed, and a valid Shodan.io API Key. You'll have copies of every step of the output, but the final output is in the csvparse.csv file.
##This script does not extract the associated IP, though you're welcome to map those yourself.

shodan download --limit 1000 encryptedesx 'http.title:"how to restore your files"'

shodan parse --fields ip_str,http.html --separator , encryptedesx.json.gz > encryptedparse.txt

cat encryptedparse.txt | grep -o '<b>.*</b>' | awk -F'<b>|</b>' '{print $2,$4,$6}' >formattedparse.txt

cat formattedparse.txt | tr ' ' ',' > csvparse.csv
